<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wallpaper 4K</title>
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #166088;
            --background-color: #ffffff;
            --text-color: #333333;
            --card-bg: #f5f5f5;
            --navbar-bg: #ffffff;
            --border-color: #e0e0e0;
            --success-color: #4caf50;
        }

        .dark-mode {
            --primary-color: #6b8cae;
            --secondary-color: #3a7ca5;
            --background-color: #121212;
            --text-color: #f5f5f5;
            --card-bg: #1e1e1e;
            --navbar-bg: #1e1e1e;
            --border-color: #333333;
            --success-color: #81c784;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            padding-top: 60px;
            padding-bottom: 20px;
            min-height: 100vh;
        }

        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background-color: var(--navbar-bg);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .navbar-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .navbar-menu {
            display: flex;
            list-style: none;
            overflow-x: auto;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            flex-grow: 1;
            margin: 0 10px;
        }

        .navbar-menu::-webkit-scrollbar {
            display: none;
        }

        .navbar-item {
            padding: 8px 12px;
            margin: 0 5px;
            cursor: pointer;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .navbar-item.active {
            background-color: var(--primary-color);
            color: white;
        }

        .dark-mode-toggle {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px;
            margin-left: 10px;
        }

        .container {
            padding: 15px;
        }

        .page-title {
            margin-bottom: 20px;
            font-size: 1.5rem;
            color: var(--primary-color);
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }

        .wallpapers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
        }

        .category-card, .wallpaper-card {
            background: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            border: 1px solid var(--border-color);
        }

        .category-card:hover, .wallpaper-card:hover {
            transform: scale(1.03);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .category-image {
            width: 100%;
            height: 100px;
            object-fit: cover;
            background: linear-gradient(45deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%);
        }

        .wallpaper-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            background: linear-gradient(45deg, #a1c4fd 0%, #c2e9fb 100%);
        }

        .category-name {
            padding: 10px;
            text-align: center;
            font-weight: 500;
        }

        .preview-container {
            margin-top: 20px;
        }

        .preview-image {
            width: 100%;
            max-height: 60vh;
            object-fit: contain;
            border-radius: 8px;
            margin-bottom: 15px;
            background: linear-gradient(45deg, #ffc3a0 0%, #ffafbd 100%);
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .btn {
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
            flex: 1;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-secondary {
            background-color: var(--card-bg);
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }

        .btn-primary:hover {
            background-color: var(--secondary-color);
        }

        .btn-secondary:hover {
            background-color: var(--border-color);
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: var(--primary-color);
            grid-column: 1 / -1;
        }

        .message {
            text-align: center;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
            background-color: var(--card-bg);
        }

        .success-message {
            background-color: var(--success-color);
            color: white;
        }

        .hidden {
            display: none;
        }

        @media (min-width: 600px) {
            .categories-grid {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            }

            .wallpapers-grid {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="navbar-title">Wallpaper 4K</div>
        <ul class="navbar-menu">
            <li class="navbar-item active" data-page="home" aria-label="Home">HOME</li>
            <li class="navbar-item" data-page="local" aria-label="Local">LOCAL</li>
            <li class="navbar-item" data-page="categories" aria-label="Categories">CATEGORIES</li>
            <li class="navbar-item" data-page="premium" aria-label="Premium">PREMIUM</li>
        </ul>
        <button class="dark-mode-toggle" aria-label="Toggle dark mode">ðŸŒ“</button>
    </nav>

    <div class="container">
        <!-- Home Page -->
        <div id="home-page" class="page">
            <h1 class="page-title">Featured Wallpapers</h1>
            <div class="wallpapers-grid" id="featured-wallpapers">
                <div class="loading">Loading featured wallpapers...</div>
            </div>
        </div>

        <!-- Local Page -->
        <div id="local-page" class="page hidden">
            <h1 class="page-title">Local Wallpapers</h1>
            <div class="wallpapers-grid" id="local-wallpapers">
                <div class="message">No local wallpapers saved yet</div>
            </div>
        </div>

        <!-- Categories Page -->
        <div id="categories-page" class="page hidden">
            <h1 class="page-title">Categories</h1>
            <div class="categories-grid" id="categories-grid">
                <!-- Categories will be loaded here -->
            </div>
        </div>

        <!-- Premium Page -->
        <div id="premium-page" class="page hidden">
            <h1 class="page-title">Premium Wallpapers</h1>
            <div class="wallpapers-grid" id="premium-wallpapers">
                <div class="message">Premium content requires subscription</div>
            </div>
        </div>

        <!-- Category Gallery Page -->
        <div id="gallery-page" class="page hidden">
            <h1 class="page-title" id="gallery-title">Category</h1>
            <div class="wallpapers-grid" id="category-wallpapers">
                <!-- Category wallpapers will be loaded here -->
            </div>
        </div>

        <!-- Wallpaper Preview Page -->
        <div id="preview-page" class="page hidden">
            <div class="preview-container">
                <img class="preview-image" id="preview-image" alt="Wallpaper preview">
                <div id="message-container"></div>
                <div class="action-buttons">
                    <button class="btn btn-primary" id="download-btn">Download</button>
                    <button class="btn btn-secondary" id="back-btn">Back</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Unsplash API configuration
        const ACCESS_KEY = '8nhYPB_g_wMqQY0p9XAPjDKwvjE7805oaMw4XVOSPO0';
        
        // App state
        let currentPage = 'home';
        let currentCategory = '';
        let currentWallpaper = null;
        let categories = [
            'Love', 'Music', 'Nature', 'News & Politics', 'Other', 
            'Patterns', 'People', 'Sayings', 'Spiritual', 'Sport'
        ];
        
        // DOM elements
        const pages = {
            home: document.getElementById('home-page'),
            local: document.getElementById('local-page'),
            categories: document.getElementById('categories-page'),
            premium: document.getElementById('premium-page'),
            gallery: document.getElementById('gallery-page'),
            preview: document.getElementById('preview-page')
        };
        
        const navbarItems = document.querySelectorAll('.navbar-item');
        const darkModeToggle = document.querySelector('.dark-mode-toggle');
        const categoriesGrid = document.getElementById('categories-grid');
        const categoryWallpapers = document.getElementById('category-wallpapers');
        const galleryTitle = document.getElementById('gallery-title');
        const previewImage = document.getElementById('preview-image');
        const downloadBtn = document.getElementById('download-btn');
        const backBtn = document.getElementById('back-btn');
        const featuredWallpapers = document.getElementById('featured-wallpapers');
        const messageContainer = document.getElementById('message-container');
        
        // Initialize the app
        function init() {
            // Set up event listeners
            setupEventListeners();
            
            // Load initial content
            loadCategories();
            loadFeaturedWallpapers();
            
            // Check for saved dark mode preference
            if (localStorage.getItem('darkMode') === 'enabled') {
                document.body.classList.add('dark-mode');
            }
        }
        
        // Set up event listeners
        function setupEventListeners() {
            // Navbar menu clicks
            navbarItems.forEach(item => {
                item.addEventListener('click', () => {
                    const page = item.dataset.page;
                    navigateTo(page);
                    
                    // Update active state
                    navbarItems.forEach(navItem => navItem.classList.remove('active'));
                    item.classList.add('active');
                });
            });
            
            // Dark mode toggle
            darkModeToggle.addEventListener('click', toggleDarkMode);
            
            // Back button in preview
            backBtn.addEventListener('click', () => {
                if (currentCategory) {
                    navigateTo('gallery');
                } else {
                    navigateTo(currentPage);
                }
            });
            
            // Download button
            downloadBtn.addEventListener('click', downloadWallpaper);
        }
        
        // Navigation function
        function navigateTo(page) {
            // Hide all pages
            Object.values(pages).forEach(p => p.classList.add('hidden'));
            
            // Show the requested page
            pages[page].classList.remove('hidden');
            
            // Update current page
            currentPage = page;
            
            // Clear any messages
            messageContainer.innerHTML = '';
        }
        
        // Toggle dark mode
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            
            // Save preference
            if (document.body.classList.contains('dark-mode')) {
                localStorage.setItem('darkMode', 'enabled');
            } else {
                localStorage.setItem('darkMode', 'disabled');
            }
        }
        
        // Load categories
        function loadCategories() {
            categoriesGrid.innerHTML = '';
            
            categories.forEach(category => {
                const card = document.createElement('div');
                card.className = 'category-card';
                card.dataset.category = category;
                card.setAttribute('aria-label', `${category} category`);
                
                card.innerHTML = `
                    <div class="category-image" data-category="${category}"></div>
                    <div class="category-name">${category}</div>
                `;
                
                card.addEventListener('click', () => openCategory(category));
                categoriesGrid.appendChild(card);
            });
        }
        
        // Open a category gallery
        function openCategory(category) {
            currentCategory = category;
            galleryTitle.textContent = category;
            categoryWallpapers.innerHTML = '<div class="loading">Loading wallpapers...</div>';
            
            navigateTo('gallery');
            fetchWallpapers(category);
        }
        
        // Fetch wallpapers from Unsplash API
        async function fetchWallpapers(category) {
            try {
                const url = `https://api.unsplash.com/search/photos?query=${encodeURIComponent(category)}&client_id=${ACCESS_KEY}&per_page=30&orientation=portrait`;
                
                const response = await fetch(url);
                const data = await response.json();
                
                displayWallpapers(data.results, categoryWallpapers);
            } catch (error) {
                console.error('Error fetching wallpapers:', error);
                categoryWallpapers.innerHTML = '<div class="loading">Failed to load wallpapers. Please try again later.</div>';
            }
        }
        
        // Load featured wallpapers
        async function loadFeaturedWallpapers() {
            try {
                const url = `https://api.unsplash.com/photos/random?client_id=${ACCESS_KEY}&count=15&orientation=portrait`;
                
                const response = await fetch(url);
                const data = await response.json();
                
                displayWallpapers(data, featuredWallpapers);
            } catch (error) {
                console.error('Error fetching featured wallpapers:', error);
                featuredWallpapers.innerHTML = '<div class="loading">Failed to load featured wallpapers. Please try again later.</div>';
            }
        }
        
        // Display wallpapers in a grid
        function displayWallpapers(wallpapers, container) {
            container.innerHTML = '';
            
            if (!wallpapers || wallpapers.length === 0) {
                container.innerHTML = '<div class="message">No wallpapers found</div>';
                return;
            }
            
            wallpapers.forEach(wallpaper => {
                const card = document.createElement('div');
                card.className = 'wallpaper-card';
                card.dataset.id = wallpaper.id;
                card.setAttribute('aria-label', wallpaper.alt_description || 'Wallpaper image');
                
                const img = document.createElement('img');
                img.className = 'wallpaper-image';
                img.alt = wallpaper.alt_description || 'Wallpaper image';
                img.loading = 'lazy';
                
                // Use small thumbnail first, then load full quality
                img.src = wallpaper.urls?.thumb || createPlaceholder();
                img.dataset.full = wallpaper.urls?.regular || createPlaceholder();
                
                img.addEventListener('click', () => previewWallpaper(wallpaper));
                card.appendChild(img);
                container.appendChild(card);
                
                // Load full quality image after small one is loaded
                if (wallpaper.urls?.regular) {
                    const fullImg = new Image();
                    fullImg.src = wallpaper.urls.regular;
                    fullImg.onload = () => {
                        img.src = wallpaper.urls.regular;
                    };
                }
            });
        }
        
        // Preview a wallpaper
        function previewWallpaper(wallpaper) {
            currentWallpaper = wallpaper;
            previewImage.src = wallpaper.urls?.regular || createPlaceholder();
            previewImage.alt = wallpaper.alt_description || 'Wallpaper preview';
            navigateTo('preview');
        }
        
        // Download wallpaper using canvas and Blob
        function downloadWallpaper() {
            if (!currentWallpaper) return;
            
            const img = new Image();
            img.crossOrigin = 'Anonymous';
            img.src = currentWallpaper.urls?.regular || createPlaceholder();
            
            img.onload = function() {
                const canvas = document.createElement('canvas');
                canvas.width = img.width;
                canvas.height = img.height;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0);
                
                canvas.toBlob(function(blob) {
                    const timestamp = new Date().getTime();
                    const category = currentCategory.toLowerCase().replace(/[^a-z0-9]+/g, '-');
                    const filename = `wallpaper-${category}-${timestamp}.jpg`;
                    
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    // Show success message
                    showMessage('Gambar tersimpan. Silakan atur sebagai wallpaper dari galeri HP Anda.');
                }, 'image/jpeg', 0.9);
            };
            
            img.onerror = function() {
                showMessage('Failed to download image. Please try again.');
            };
        }
        
        // Show a message
        function showMessage(text) {
            messageContainer.innerHTML = `
                <div class="message success-message">${text}</div>
            `;
        }
        
        // Create a placeholder image
        function createPlaceholder() {
            return 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCI+PHJlY3Qgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiIGZpbGw9IiNGRjljYjEiLz48cGF0aCBkPSJNMCAwTDEwMCAxMDAiIHN0cm9rZT0iI0ZGRiIgc3Ryb2tlLXdpZHRoPSIyIi8+PHBhdGggZD0iTTEwMCAwTDAgMTAwIiBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMiIvPjwvc3ZnPg==';
        }
        
        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
