<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wallpaper 4K</title>
<style>
:root {
    --primary-color: #4a6fa5;
    --secondary-color: #166088;
    --background-color: #ffffff;
    --text-color: #333333;
    --card-bg: #f5f5f5;
    --navbar-bg: #ffffff;
    --border-color: #e0e0e0;
}
.dark-mode {
    --primary-color: #6b8cae;
    --secondary-color: #3a7ca5;
    --background-color: #121212;
    --text-color: #f5f5f5;
    --card-bg: #1e1e1e;
    --navbar-bg: #1e1e1e;
    --border-color: #333333;
}
* { margin:0; padding:0; box-sizing:border-box; transition: background-color 0.3s,color 0.3s; }
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: var(--background-color);
    color: var(--text-color);
    padding-top: 60px;
    min-height: 100vh;
}
.navbar {
    position: fixed; top:0; left:0; right:0;
    background-color: var(--navbar-bg);
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    z-index:1000;
    display:flex; justify-content:space-between; align-items:center;
    padding:10px 15px;
    border-bottom:1px solid var(--border-color);
}
.navbar-title { font-size:1.2rem; font-weight:bold; color:var(--primary-color); }
.navbar-menu { display:flex; list-style:none; overflow-x:auto; white-space:nowrap; scrollbar-width:none; }
.navbar-menu::-webkit-scrollbar { display:none; }
.navbar-item { padding:8px 12px; margin:0 5px; cursor:pointer; border-radius:4px; font-size:0.9rem; }
.navbar-item.active { background-color: var(--primary-color); color:white; }
.dark-mode-toggle { background:none; border:none; color:var(--text-color); font-size:1.2rem; cursor:pointer; padding:5px; margin-left:10px; }
.container { padding:15px; }
.page-title { margin-bottom:20px; font-size:1.5rem; color:var(--primary-color); }
.categories-grid, .wallpapers-grid {
    display:grid; gap:10px;
}
.categories-grid { grid-template-columns: repeat(auto-fill, minmax(150px,1fr)); }
.wallpapers-grid { grid-template-columns: repeat(auto-fill, minmax(120px,1fr)); }
.category-card, .wallpaper-card {
    background:var(--card-bg); border-radius:8px; overflow:hidden; box-shadow:0 2px 5px rgba(0,0,0,0.1);
    cursor:pointer; transition: transform 0.2s, box-shadow 0.2s; border:1px solid var(--border-color);
}
.category-card:hover, .wallpaper-card:hover { transform:scale(1.02); box-shadow:0 5px 15px rgba(0,0,0,0.2); }
.category-image, .wallpaper-image, .preview-image {
    width:100%; object-fit:cover; background:linear-gradient(45deg,#a1c4fd 0%,#c2e9fb 100%);
}
.category-image { height:100px; }
.preview-container { margin-top:20px; }
.preview-image { max-height:60vh; border-radius:8px; margin-bottom:15px; }
.action-buttons { display:flex; gap:10px; margin-bottom:20px; }
.btn { padding:10px 15px; border:none; border-radius:4px; font-weight:500; cursor:pointer; transition: background-color 0.2s; }
.btn-primary { background-color:var(--primary-color); color:white; }
.btn-secondary { background-color:var(--card-bg); color:var(--text-color); border:1px solid var(--border-color); }
.btn-primary:hover { background-color:var(--secondary-color); }
.btn-secondary:hover { background-color:var(--border-color); }
.hidden { display:none; }
.loading { text-align:center; padding:20px; color:var(--primary-color); }
@media (min-width:600px){.categories-grid{grid-template-columns:repeat(auto-fill,minmax(180px,1fr));}.wallpapers-grid{grid-template-columns:repeat(auto-fill,minmax(160px,1fr));}}
</style>
</head>
<body>
<nav class="navbar">
    <div class="navbar-title">Wallpaper 4K</div>
    <ul class="navbar-menu">
        <li class="navbar-item active" data-page="home">HOME</li>
        <li class="navbar-item" data-page="local">LOCAL</li>
        <li class="navbar-item" data-page="categories">CATEGORIES</li>
        <li class="navbar-item" data-page="premium">PREMIUM</li>
    </ul>
    <button class="dark-mode-toggle" aria-label="Toggle dark mode">ðŸŒ“</button>
</nav>
<div class="container">
    <div id="home-page" class="page"><h1 class="page-title">Featured Wallpapers</h1><div class="wallpapers-grid" id="featured-wallpapers"></div></div>
    <div id="local-page" class="page hidden"><h1 class="page-title">Local Wallpapers</h1><div class="wallpapers-grid" id="local-wallpapers"><div class="loading">No local wallpapers saved yet</div></div></div>
    <div id="categories-page" class="page hidden"><h1 class="page-title">Categories</h1><div class="categories-grid" id="categories-grid"></div></div>
    <div id="premium-page" class="page hidden"><h1 class="page-title">Premium Wallpapers</h1><div class="wallpapers-grid" id="premium-wallpapers"><div class="loading">Premium content requires subscription</div></div></div>
    <div id="gallery-page" class="page hidden"><h1 class="page-title" id="gallery-title">Category</h1><div class="wallpapers-grid" id="category-wallpapers"></div></div>
    <div id="preview-page" class="page hidden">
        <div class="preview-container">
            <img class="preview-image" id="preview-image" alt="Wallpaper preview">
            <div class="action-buttons">
                <button class="btn btn-primary" id="download-btn">Download</button>
                <button class="btn btn-secondary" id="back-btn">Back</button>
            </div>
        </div>
    </div>
</div>
<script>
const ACCESS_KEY = '8nhYPB_g_wMqQY0p9XAPjDKwvjE7805oaMw4XVOSPO0';
const SECRET_KEY = 'YCJVmICHsrm-RWjQEwSk9TEnolqcYaJeIZg1Af504AY';

let currentPage='home', previousPage='home', currentCategory='', currentWallpaper=null;
let categories=['Love','Music','Nature','News & Politics','Other','Patterns','People','Sayings','Spiritual','Sport'];

const pages={home:document.getElementById('home-page'),local:document.getElementById('local-page'),categories:document.getElementById('categories-page'),premium:document.getElementById('premium-page'),gallery:document.getElementById('gallery-page'),preview:document.getElementById('preview-page')};
const navbarItems=document.querySelectorAll('.navbar-item');
const darkModeToggle=document.querySelector('.dark-mode-toggle');
const categoriesGrid=document.getElementById('categories-grid');
const categoryWallpapers=document.getElementById('category-wallpapers');
const galleryTitle=document.getElementById('gallery-title');
const previewImage=document.getElementById('preview-image');
const downloadBtn=document.getElementById('download-btn');
const backBtn=document.getElementById('back-btn');
const featuredWallpapers=document.getElementById('featured-wallpapers');

function init(){
    setupEventListeners();
    loadCategories();
    loadFeaturedWallpapers();
    if(localStorage.getItem('darkMode')==='enabled'){document.body.classList.add('dark-mode');}
}

function setupEventListeners(){
    navbarItems.forEach(item=>{item.addEventListener('click',()=>{navigateTo(item.dataset.page); navbarItems.forEach(navItem=>navItem.classList.remove('active')); item.classList.add('active');});});
    darkModeToggle.addEventListener('click',toggleDarkMode);
    backBtn.addEventListener('click',()=>{navigateTo(previousPage);});
    downloadBtn.addEventListener('click', downloadWallpaperCanvas);
}

function navigateTo(page){
    Object.values(pages).forEach(p=>p.classList.add('hidden'));
    pages[page].classList.remove('hidden');
    currentPage=page;
    if(page==='categories'){loadCategories();}
}

function toggleDarkMode(){
    document.body.classList.toggle('dark-mode');
    if(document.body.classList.contains('dark-mode')){localStorage.setItem('darkMode','enabled');}else{localStorage.setItem('darkMode','disabled');}
}

function loadCategories(){
    categoriesGrid.innerHTML='';
    categories.forEach(category=>{
        const card=document.createElement('div'); card.className='category-card'; card.dataset.category=category;
        card.innerHTML=`<div class="category-image"></div><div class="category-name">${category}</div>`;
        card.addEventListener('click',()=>openCategory(category));
        categoriesGrid.appendChild(card);
    });
}

function openCategory(category){
    currentCategory=category;
    galleryTitle.textContent=category;
    categoryWallpapers.innerHTML='<div class="loading">Loading wallpapers...</div>';
    previousPage='categories';
    navigateTo('gallery');
    fetchWallpapers(category);
}

async function fetchWallpapers(category){
    try{
        const url=`https://api.unsplash.com/search/photos?query=${encodeURIComponent(category)}&client_id=${ACCESS_KEY}&per_page=20&orientation=portrait`;
        const response=await fetch(url);
        const data=await response.json();
        displayWallpapers(data.results,categoryWallpapers);
    }catch(err){
        console.error(err);
        categoryWallpapers.innerHTML='<div class="loading">Failed to load wallpapers. Please try again later.</div>';
    }
}

async function loadFeaturedWallpapers(){
    try{
        const url=`https://api.unsplash.com/photos/random?client_id=${ACCESS_KEY}&count=10&orientation=portrait`;
        const response=await fetch(url);
        const data=await response.json();
        displayWallpapers(data,featuredWallpapers);
    }catch(err){
        console.error(err);
        featuredWallpapers.innerHTML='<div class="loading">Failed to load featured wallpapers. Please try again later.</div>';
    }
}

function displayWallpapers(wallpapers,container){
    container.innerHTML='';
    if(!wallpapers || wallpapers.length===0){container.innerHTML='<div class="loading">No wallpapers found</div>'; return;}
    wallpapers.forEach(w=>{
        const card=document.createElement('div'); card.className='wallpaper-card'; card.dataset.id=w.id;
        const img=document.createElement('img'); img.className='wallpaper-image';
        img.alt=w.alt_description||'Wallpaper image'; img.loading='lazy';
        img.src=w.urls?.thumb||createPlaceholder(); img.dataset.full=w.urls?.regular||createPlaceholder();
        img.addEventListener('click',()=>previewWallpaper(w));
        card.appendChild(img);
        container.appendChild(card);
        if(w.urls?.regular){const fullImg=new Image(); fullImg.src=w.urls.regular; fullImg.onload=()=>{img.src=w.urls.regular;};}
    });
}

function previewWallpaper(wallpaper){
    previousPage=currentPage;
    currentWallpaper=wallpaper;
    previewImage.src=wallpaper.urls?.regular||createPlaceholder();
    previewImage.alt=wallpaper.alt_description||'Wallpaper preview';
    navigateTo('preview');
}

function downloadWallpaper(){
    if(!currentWallpaper) return;
    const imageUrl=currentWallpaper.urls?.regular||createPlaceholder();
    const timestamp=new Date().getTime();
    const category=currentCategory?currentCategory.toLowerCase().replace(/[^a-z0-9]+/g,'-'):'featured';
    const filename=`wallpaper-${category}-${timestamp}.jpg`;
    fetch(imageUrl).then(r=>r.blob()).then(blob=>{
        const blobUrl=URL.createObjectURL(blob);
        const link=document.createElement('a');
        link.href=blobUrl; link.download=filename;
        document.body.appendChild(link); link.click(); document.body.removeChild(link);
        URL.revokeObjectURL(blobUrl);
    }).catch(err=>console.error('Download error:',err));
}

function createPlaceholder(){return 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCI+PHJlY3Qgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiIGZpbGw9IiNGRjljYjEiLz48cGF0aCBkPSJNMCAwTDEwMCAxMDAiIHN0cm9rZT0iI0ZGRiIgc3Ryb2tlLXdpZHRoPSIyIi8+PHBhdGggZD0iTTEwMCAwTDAgMTAwIiBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMiIvPjwvc3ZnPg==';}

document.addEventListener('DOMContentLoaded',init);
</script>
</body>
</html>
